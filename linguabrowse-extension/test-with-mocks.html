<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LinguaBrowse Test Page (With Mocks)</title>
  <link rel="stylesheet" href="styles/overlay.css">
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      line-height: 1.6;
      color: #333;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
    }
    
    h1, h2, h3 {
      color: #2563eb;
    }
    
    p {
      margin: 16px 0;
    }
    
    .article {
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      padding: 24px;
      margin: 32px 0;
      background-color: #f9fafb;
    }
    
    .article-title {
      font-size: 24px;
      margin-top: 0;
    }
    
    .highlight {
      background-color: #fef3c7;
      padding: 2px 4px;
      border-radius: 4px;
    }
    
    .test-controls {
      background-color: #eff6ff;
      padding: 16px;
      border-radius: 8px;
      margin-top: 40px;
    }
    
    button {
      background-color: #2563eb;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      margin-right: 8px;
      margin-bottom: 8px;
    }
    
    button:hover {
      background-color: #1d4ed8;
    }
    
    .debug-log {
      background-color: #f0f0f0;
      border: 1px solid #ddd;
      padding: 10px;
      margin-top: 20px;
      max-height: 200px;
      overflow-y: auto;
      font-family: monospace;
      font-size: 12px;
    }
    
    .log-entry {
      margin: 4px 0;
      border-bottom: 1px solid #eee;
      padding-bottom: 4px;
    }
  </style>
</head>
<body>
  <h1>LinguaBrowse Test Page (With Mocks)</h1>
  
  <p>This page contains sample content and test controls to demonstrate the LinguaBrowse extension with added features:</p>
  <ul>
    <li><strong>Audio Pronunciation</strong> - Hear words spoken with audio buttons</li>
    <li><strong>Spaced Repetition</strong> - Track learning progress with optimized scheduling</li>
    <li><strong>Enhanced Dictionary</strong> - Expanded word information with examples</li>
  </ul>
  
  <div class="article">
    <h2 class="article-title">The Benefits of Learning a New Language</h2>
    
    <p>Learning a new <span class="highlight">language</span> is one of the most rewarding experiences you can undertake. It opens doors to new cultures, enhances your cognitive abilities, and improves your career prospects. Whether you're learning for personal or professional reasons, the benefits are numerous.</p>
    
    <p>When you learn a language, your <span class="highlight">brain</span> creates new neural pathways. This mental exercise has been shown to improve memory, enhance problem-solving skills, and even delay the onset of dementia. It's like a workout for your mind!</p>
    
    <h3>Cultural Understanding</h3>
    
    <p>Language and culture are deeply intertwined. By learning a <span class="highlight">language</span>, you gain insights into the values, traditions, and worldview of its speakers. You can read literature in its original form, watch films without subtitles, and connect with people on a deeper level when you travel.</p>
    
    <p>For example, understanding the concept of "hygge" in Danish, "wabi-sabi" in Japanese, or "sobremesa" in Spanish gives you access to cultural ideas that don't have direct translations in English.</p>
    
    <h3>Career Advantages</h3>
    
    <p>In today's global economy, speaking more than one <span class="highlight">language</span> is a valuable skill. Many employers seek candidates who can communicate with international partners, clients, or customers. Depending on the languages you learn and your industry, being bilingual or multilingual could increase your salary by 5-20%.</p>
    
    <p>Languages particularly in demand include Mandarin Chinese, Spanish, Arabic, and German, though the specific value varies by region and sector.</p>
  </div>
  
  <div class="test-controls">
    <h3>Testing Controls</h3>
    <p>Use these buttons to test specific functionality:</p>
    <button id="init-extension">1. Initialize Extension</button>
    <button id="show-quiz" disabled>2. Show Quiz</button>
    <button id="complete-quiz" disabled>3. Complete Quiz Sequence</button>
    <button id="show-results" disabled>4. Show Results Screen</button>
    
    <div class="debug-log" id="debug-log">
      <div class="log-entry">Debug log - actions will appear here</div>
    </div>
  </div>
  
  <script src="js/services/audioService-browser.js"></script>
  <script src="js/services/spacedRepetition-browser.js"></script>
  <script src="js/services/dictionaryService-browser.js"></script>
  
  <script>
    // Debug logging function
    function logDebug(message) {
      const logContainer = document.getElementById('debug-log');
      const entry = document.createElement('div');
      entry.className = 'log-entry';
      entry.textContent = message;
      logContainer.appendChild(entry);
      logContainer.scrollTop = logContainer.scrollHeight;
    }
    
    // Mock Chrome APIs
    if (typeof chrome === 'undefined') {
      window.chrome = {
        runtime: {
          sendMessage: function(message, callback) {
            logDebug(`Chrome API: sendMessage ${JSON.stringify(message)}`);
            if (message.type === 'getUserData') {
              callback({
                settings: {
                  targetLanguage: 'spanish',
                  quizFrequency: 'high',
                  subscription: 'premium',
                  dailyGoal: 10
                },
                stats: {
                  quizzesToday: 0,
                  streakDays: 7,
                  wordsLearned: 52
                },
                quizState: null
              });
            } else if (message.type === 'quizCompleted') {
              logDebug(`Quiz result: ${message.correct ? 'Correct' : 'Incorrect'} for word "${message.word}"`);
            }
          }
        }
      };
    }
    
    // Test controller
    document.addEventListener('DOMContentLoaded', function() {
      const initButton = document.getElementById('init-extension');
      const showQuizButton = document.getElementById('show-quiz');
      const completeQuizButton = document.getElementById('complete-quiz');
      const showResultsButton = document.getElementById('show-results');
      
      // Get current state from content.js
      let quizActive = false;
      
      // Initialize extension button
      initButton.addEventListener('click', function() {
        logDebug('Initializing extension with mock data...');
        
        // Initialize the LinguaBrowse extension
        state.settings = {
          targetLanguage: 'spanish',
          quizFrequency: 'high',
          subscription: 'premium',
          dailyGoal: 10
        };
        state.stats = {
          quizzesToday: 0,
          streakDays: 7,
          wordsLearned: 52
        };
        
        // Manually run the analyzePageContent and prepareQuizzes functions
        analyzePageContent();
        
        logDebug(`Page language detected: ${state.pageLanguage}`);
        logDebug(`Quiz queue has ${state.quizQueue.length} items`);
        
        showQuizButton.disabled = false;
        initButton.disabled = true;
      });
      
      // Show quiz button
      showQuizButton.addEventListener('click', function() {
        logDebug('Showing quiz...');
        initializeQuizSequence();
        completeQuizButton.disabled = false;
      });
      
      // Complete quiz sequence button (simulate answering all questions)
      completeQuizButton.addEventListener('click', function() {
        logDebug('Completing quiz sequence...');
        
        // Get all active quiz elements and simulate clicking the first option
        // This will advance through the quiz
        const quizOverlay = document.querySelector('.linguabrowse-quiz-overlay');
        if (quizOverlay) {
          const options = quizOverlay.querySelectorAll('.linguabrowse-quiz-option');
          if (options.length > 0) {
            options[0].click();
            
            // Now click the next button
            setTimeout(() => {
              const nextButton = quizOverlay.querySelector('.linguabrowse-next-button');
              if (nextButton) nextButton.click();
            }, 500);
          }
        } else {
          logDebug('No active quiz found');
        }
        
        showResultsButton.disabled = false;
      });
      
      // Show results button
      showResultsButton.addEventListener('click', function() {
        logDebug('Showing quiz results screen...');
        state.sequenceActive = false;
        showQuizResults();
      });
    });
  </script>
  
  <script src="content.js"></script>
</body>
</html>
